<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registering Clients :: Uyuni Documentation (Prototype)</title>
    <meta name="generator" content="Antora 1.0.3">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/site-extra.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
    <!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css -->
    <link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a href="https://jcayouette.github.io/personal-blog">Belief and Reason</a>
        <span class="separator">//</span>
        <a href="../..">Library</a>
      </div>
      <div class="navbar-item">
        <input id="search-input" type="text" placeholder="Search docs">
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Projects</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>Resources</strong></div>
            <a class="navbar-item" href="https://github.com/jcayouette/personal-blog">Repository</a>
            <a class="navbar-item" href="https://github.com/jcayouette/personal-blog/issues">Issue Tracker</a>
<!--
            <hr class="navbar-divider">
            <div class="navbar-item"><strong>Custom UI (coming soon!)</strong></div>
            <a class="navbar-item" href="https://gitlab.com/antora/antora-ui-default">Repository</a>
            <a class="navbar-item" href="https://gitlab.com/antora/antora-ui-default/issues">Issue Tracker</a>
            <hr class="navbar-divider">
          -->
            <a class="navbar-item" href="https://github.com/jcayouette/blob/master/contributing.adoc">Contributing</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Community</div>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://discord.gg/vmrAYE3">Discord Chat</a>
          </div>
        </div>
        <a class="navbar-item" href="https://twitter.com/BaR-project">
          <span class="icon">
            <svg aria-hidden="true" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
              <path fill="#57aaee" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path>
            </svg>
          </span>
        </a>
      </div>
    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="uyuni" data-version="dev">
  <aside class="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="MAIN-manager.html">Uyuni</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="book_mgr_getting_started.html">Getting Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="quickstart3_chap_install_overview.html">Overview and Requirements</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.introduction">Introduction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq">Prerequisites for Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq.scc">SUSE SCC Credentials</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq.installmedia">Get Uyuni</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq.hardware">Hardware Requirements</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq.network">Network Requirements</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq.clientos">Supported Client Systems</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="quickstart3_chap_suma_installation_jeos.html">Installation via JeOS</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.kvm.settings">Configuring KVM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#jeos.kvm.settings">JeOS KVM Settings</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#jeos.susemgr.prep">Preparing JeOS for Uyuni</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quickstart3_chap_suma_installation_sles.html">Installation via SLES</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quickstart3_chap_suma_setup_with_yast.html">Setup and Configuration</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="quickstart3_chap_suma_keys_and_first_client.html">Connecting Clients</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quickstart3_chap_suma_salt_gs.html">Introduction to Salt</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="book_mgr_best_practices.html">Best Practices</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="book_suma_reference_manual.html">WebUI Reference</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="book_suma_advanced_topics.html">Advanced Topics</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Uyuni</span>
    <span class="version">dev</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Uyuni</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="MAIN-manager.html">dev</a>
        </li>
        <li class="version">
          <a href="../3.2/MAIN-manager.html">3.2</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="MAIN-manager.html" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="MAIN-manager.html">Uyuni</a></li>
    <li class="crumb"><a href="book_mgr_getting_started.html">Getting Started</a></li>
    <li class="crumb"><a href="quickstart3_chap_suma_keys_and_first_client.html">Connecting Clients</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="versions-menu-toggle" title="Show other versions of page">dev</button>
  <div class="versions-menu">
    <a class="version is-current" href="quickstart3_chap_suma_keys_and_first_client.html">dev</a>
    <a class="version" href="../3.2/quickstart3_chap_suma_keys_and_first_client.html">3.2</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/jcayouette/uyuni-doc-test/edit/master/docs/modules/ROOT/pages/quickstart3_chap_suma_keys_and_first_client.adoc">Edit this Page</a></div>
</div>
<article class="doc">
<h1>Registering Clients</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#create.act.keys">Creating Activation Keys</a></li>
<li><a href="#create.tools.repository">Creating the  Tools Repository</a></li>
<li><a href="#registering.clients.traditional">Registering Traditional Clients</a>
<ul class="sectlevel2">
<li><a href="#generate.bootstrap.script">Generating a Bootstrap Script</a></li>
<li><a href="#modify.bootstrap.script">Editing the Bootstrap Script</a></li>
<li><a href="#connect.first.client">Connecting Clients</a></li>
<li><a href="#sect.tradclient.packagelock">Package Locks</a></li>
</ul>
</li>
<li><a href="#preparing.and.registering.clients.salt">Registering Salt Clients</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a><a class="link" href="#_introduction">Introduction</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Releases prior to  2.1 were shipped with a <strong>traditional</strong> client management framework (which is still fully supported today).
SUSE Manager 3 and later include the Salt framework in addition to the <strong>traditional</strong> framework.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Salt</dt>
<dd>
<p>Is an end-to-end data-center automation tool which may also be used outside the scope of  to introduce reactive, real-time orchestration, and configuration management.
Managed systems can coexist using both <strong>traditional</strong> and <strong>Salt</strong> frameworks.
This functionality provides a safe learning environment when switching to <strong>Salt</strong> while you continue to maintain existing deployments.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create.act.keys"><a class="anchor" href="#create.act.keys"></a><a class="link" href="#create.act.keys">Creating Activation Keys</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following procedure will guide you through creating the activation keys for your test channels.
Activation keys can be used with both Salt and traditional clients.</p>
</div>
<div class="paragraph">
<p>Activation keys define the number of software entitlements, channels, and groups a client system is allowed to subscribe to.
This information is passed on to all systems registered with said key.
Each activation key is bound to the organization for which it has been created.</p>
</div>
<div id="create.activation.keys" class="olist arabic">
<div class="title">Procedure: Creating Activation Keys</div>
<ol class="arabic">
<li>
<p>As the administrator login to the  WebUI.</p>
</li>
<li>
<p>Switch to <span class="menuseq"><b class="menu">Systems</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Activation Keys</b></span>.</p>
</li>
<li>
<p>Click the <b class="button">Create Key</b> link at the upper right corner.</p>
<div class="imageblock">
<div class="content">
<img src="_images/systems_create_activation_key.png" alt="systems create activation key">
</div>
</div>
</li>
<li>
<p>Enter an <span class="menuseq"><b class="menu">Activation Key Details</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Description</b></span> to identify the generated activation key.</p>
</li>
<li>
<p>Enter a human readable <span class="menuseq"><b class="menu">Activation Key Details</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Key</b></span> string value such as <strong>SLES12-SP3</strong> to represent the distribution and service pack associated with the key.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title=":warning:"></i>
</td>
<td class="content">
<div class="title">Allowed Characters</div>
For all SUSE
Products do not use commas within the key string.
Red Hat Products require commas.
For more information, see <a href="#ref.webui.systems.activ-keys">[ref.webui.systems.activ-keys]</a>.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Select the SUSE Linux Enterprise channel that was added during
<a href="#">quickstart3_chap_sumasetup_with_yast.adoc#gs-syncing-with-scc</a>
from the <span class="menuseq"><b class="menu">Activation Key Details</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Base Channels</b></span> drop down.</p>
</li>
<li>
<p>For this guide leave <span class="menuseq"><b class="menu">Activation Key Details</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Contact Method</b></span> set to default.</p>
</li>
<li>
<p><span class="menuseq"><b class="menu">Activation Key Details</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Universal Default</b></span> should remain unchecked. Click <b class="button">Update Activation Key</b> to complete creation of the activation key.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create.tools.repository"><a class="anchor" href="#create.tools.repository"></a><a class="link" href="#create.tools.repository">Creating the  Tools Repository</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section you will create a tools repository on the  Server for providing client tools.
The client tools repository contains packages for installing Salt on minions as well as required packages for registering traditional clients during the bootstrapping procedure.
These packages will be installed from the newly generated repository during the registration process.
In the following procedure you will create the SUSE Linux Enterprise tools repository.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title=":heavy_exclamation_mark:"></i>
</td>
<td class="content">
<div class="title">Creating a Tools Repository when an SCC Channel has not been Synced</div>
<div class="paragraph">
<p>Before following the procedure to create the tools repository make sure the SUSE vendor channel you will be using with your client has been completely synced.
You can check this by running <code class="command">tail -f /var/log/rhn/reposync/</code>&lt;CHANNEL_NAME&gt;<code>.log</code> as <em>root</em>.
In the following example replace <code class="replaceable">version</code> with the actual version string:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tail -f /var/log/rhn/reposync/sles`version`-pool-x86_64.log</pre>
</div>
</div>
<div class="paragraph">
<p>Once completed you should see the following output in your terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>2017/12/12 15:20:32 +02:00 Importing packages started.
2017/12/12 15:22:02 +02:00 1.07 %
...
2017/12/12 15:34:25 +02:00 86.01 %
2017/12/12 15:35:49 +02:00 Importing packages finished.
2017/12/12 15:35:49 +02:00 Linking packages to channel.
...
2017/12/12 15:35:59 +02:00 Sync completed.</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure: Generating the Tools Repository for SUSE Linux Enterprise</div>
<ol class="arabic">
<li>
<p>Open a terminal on the server as root and enter the following command to list available bootstrap repositories:</p>
<div class="listingblock">
<div class="content">
<pre>mgr-create-bootstrap-repo -l SLE-`version`-x86_64</pre>
</div>
</div>
</li>
<li>
<p>Then invoke the same command using the listed repository as the product label to actually create the bootstrap repository:</p>
<div class="listingblock">
<div class="content">
<pre>mgr-create-bootstrap-repo -c SLE-version-x86_64</pre>
</div>
</div>
</li>
<li>
<p> will create and add the client tools to the newly created <code class="path">repositories</code> directory located at <code class="path">/srv/www/htdocs/pub/repositories/</code> .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This repository is suitable for both Server and Desktop of SUSE Linux Enterprise
.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="registering.clients.traditional"><a class="anchor" href="#registering.clients.traditional"></a><a class="link" href="#registering.clients.traditional">Registering Traditional Clients</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="generate.bootstrap.script"><a class="anchor" href="#generate.bootstrap.script"></a><a class="link" href="#generate.bootstrap.script">Generating a Bootstrap Script</a></h3>
<div class="paragraph">
<p>This section goes over generating a template bootstrap script which will be copied and modified for use with &#8220;traditional&#8221; clients.
Traditional clients register with  via a bootstrap script executed on the client which deploys all necessary packages to it.
The bootstrap script contains parameters which assigns a client system to its base channel.
Two of these important parameters are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Activation Keys</p>
</li>
<li>
<p>GNU Privacy Guard (GPG) Keys</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title=":information_source:"></i>
</td>
<td class="content">
<div class="title">SLES 15 and Python 3</div>
<div class="paragraph">
<p>SLES 15 utilizes Python 3 by default.  Because of this change any older
bootstrap scripts (based on python 2) must be re-created for SLES 15 systems. Attempting to
register SLES 15 systems with SUSE Manager using Python 2 versions of the bootstrap script will
fail.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following procedure will guide you through generating a bootstrap script.</p>
</div>
<div id="create.boot.script" class="olist arabic">
<div class="title">Procedure: Creating a Bootstrap Script</div>
<ol class="arabic">
<li>
<p>From the  WebUI, browse to <span class="menuseq"><b class="menu">Main Menu</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Admin</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Manager Configuration</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Bootstrap Script</b></span>. For more information, see <a href="#s3-sattools-config-bootstrap">[s3-sattools-config-bootstrap]</a>.</p>
</li>
<li>
<p>In the <code class="guimenu">SUSE Manager Configuration - Bootstrap</code> dialog disable <code class="guimenu">Bootstrap using Salt</code>.
Use default settings and click the <b class="button">Update</b> button.</p>
<div class="imageblock">
<div class="content">
<img src="_images/mgr_configuration_bootstrap_trad.png" alt="mgr configuration bootstrap trad">
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title=":warning:"></i>
</td>
<td class="content">
<div class="title">Using SSL</div>
<div class="paragraph">
<p>Unchecking <b class="menuref">Enable SSL</b> in the WebUI or setting <code>USING_SSL=0</code> in the bootstrap script is not recommended.
If you disable SSL nevertheless you will need to manage custom CA certificates to be able to run the registration process successfully.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>A template bootstrap script is generated and stored on the server&#8217;s file system in the <code class="path">/srv/www/htdocs/pub/bootstrap</code> directory.</p>
<div class="listingblock">
<div class="content">
<pre>cd /srv/www/htdocs/pub/bootstrap</pre>
</div>
</div>
<div class="paragraph">
<p>The bootstrap script is also available at <code class="path"><a href="https://example.com/pub/bootstrap/bootstrap.sh" class="bare">https://example.com/pub/bootstrap/bootstrap.sh</a></code>
.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a href="#modify.bootstrap.script">Editing the Bootstrap Script</a> will cover copying and modifying your bootstrap template for use with each client.</p>
</div>
</div>
<div class="sect2">
<h3 id="modify.bootstrap.script"><a class="anchor" href="#modify.bootstrap.script"></a><a class="link" href="#modify.bootstrap.script">Editing the Bootstrap Script</a></h3>
<div class="paragraph">
<p>In this section you will copy and modify the template bootstrap script you created from <a href="#generate.bootstrap.script">Generating a Bootstrap Script</a>.</p>
</div>
<div class="paragraph">
<p>A minimal requirement when modifying a bootstrap script for use with  is the inclusion of an activation key.
Depending on your organizations security requirements it is strongly recommended to include one or more (GPG) keys (for example, your organization key, and package signing keys).
For this tutorial you will be registering with the activation keys created in the previous section.</p>
</div>
<div id="mod.bootstrap.script" class="olist arabic">
<div class="title">Procedure: Modifying the Bootstrap Script</div>
<ol class="arabic">
<li>
<p>Login as root from the command line on your  server.</p>
</li>
<li>
<p>Navigate to the bootstrap directory with:</p>
<div class="listingblock">
<div class="content">
<pre>cd /srv/www/htdocs/pub/bootstrap/</pre>
</div>
</div>
</li>
<li>
<p>Create and rename two copies of the template bootstrap script for use with each of your clients.</p>
<div class="listingblock">
<div class="content">
<pre>cp bootstrap.sh bootstrap-sles11.sh
cp bootstrap.sh bootstrap-sles12.sh</pre>
</div>
</div>
</li>
<li>
<p>Open <code class="path">sles12.sh</code> for modification.
Scroll down and modify both lines marked in green.
You must comment out <code>exit 1</code> with a hash mark (<code>\#</code>) to activate the script and then enter the name of the key for this script in the <code>ACTIVATION_KEYS=</code> field as follows:</p>
<div class="listingblock">
<div class="content">
<pre>echo "Enable this script: comment (with #'s) this block (or, at least just"
echo "the exit below)"
echo
#exit 1

# can be edited, but probably correct (unless created during initial install):
# NOTE: ACTIVATION_KEYS *must* be used to bootstrap a client machine.
ACTIVATION_KEYS=1-sles12
ORG_GPG_KEY=</pre>
</div>
</div>
</li>
<li>
<p>Once you have completed your modifications save the file and repeat this procedure for the second bootstrap script.
Proceed to <a href="#connect.first.client">Connecting Clients</a>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title=":information_source:"></i>
</td>
<td class="content">
<div class="title">Finding Your Keys</div>
<div class="paragraph">
<p>To find key names you have created: In the WebUI, click <span class="menuseq"><b class="menu">Home</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Overview</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Manage Activation keys</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Key Field</b></span>.
All keys created for channels are listed on this page.
You must enter the full name of the key you wish to use in the bootstrap script exactly as presented in the key field.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="connect.first.client"><a class="anchor" href="#connect.first.client"></a><a class="link" href="#connect.first.client">Connecting Clients</a></h3>
<div class="paragraph">
<p>This section covers connecting your clients to  with the modified bootstrap script.</p>
</div>
<div id="run.bootstrap.script" class="olist arabic">
<div class="title">Procedure: Running the Bootstrap Script</div>
<ol class="arabic">
<li>
<p>From your  Server command line as root navigate to the following directory:</p>
<div class="listingblock">
<div class="content">
<pre>cd /srv/www/htdocs/pub/bootstrap/</pre>
</div>
</div>
</li>
<li>
<p>Run the following command to execute the bootstrap script on the client:</p>
<div class="listingblock">
<div class="content">
<pre>cat MODIFIED-SCRIPT.SH \
| ssh root@example.com /bin/bash</pre>
</div>
</div>
</li>
<li>
<p>The script will execute and proceed to download the required dependencies located in the repositories directory you created earlier.
Once the script has finished running, log in to the WebUI and click <span class="menuseq"><b class="menu">Systems</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Overview</b></span> to see the new client listed.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This concludes the bootstrap section of this guide. <a href="#preparing.and.registering.clients.salt">Registering Salt Clients</a> will go over registering Salt minions for use with .</p>
</div>
</div>
<div class="sect2">
<h3 id="sect.tradclient.packagelock"><a class="anchor" href="#sect.tradclient.packagelock"></a><a class="link" href="#sect.tradclient.packagelock">Package Locks</a></h3>
<div class="paragraph">
<p>Package locks are used to prevent unauthorized installation or upgrades to software packages on traditional clients.
When a package has been locked, it will display to users with a padlock icon, indicating that it can not be installed.
Any attempt to install a locked package will be reported as an error in the event log.</p>
</div>
<div class="paragraph">
<p>Locked packages can not be installed, upgraded, or removed, either through the  WebUI, or directly on the client machine using a package manager.
Locked packages will also indirectly lock any dependent packages.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title=":information_source:"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Package locks can only be used on traditional clients that use the Zypper package manager.
The feature is not currently supported on Red Hat Linux Enterprise or Salt clients.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure: Using Package Locks</div>
<ol class="arabic">
<li>
<p>On the client machine, install the <code class="package">zypp-plugin-spacewalk</code> package:</p>
<div class="listingblock">
<div class="content">
<pre># zypper in zypp-plugin-spacewalk</pre>
</div>
</div>
</li>
<li>
<p>Navigate to the <span class="menuseq"><b class="menu">Software</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Packages</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Lock</b></span> tab on the managed system to see a list of all available packages.</p>
</li>
<li>
<p>Select the packages to lock, and click <b class="button">Request Lock</b>.
You can also choose to enter a date and time for the lock to activate.
Note that even if you do not select a date and time, the lock might not activate immediately.</p>
</li>
<li>
<p>To remove a package lock, select the packages to unlock and click <b class="button">Request Unlock</b>.
You can also choose to enter a date and time for the lock to deactivate.
Note that even if you do not select a date and time, the lock might not deactivate immediately.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="preparing.and.registering.clients.salt"><a class="anchor" href="#preparing.and.registering.clients.salt"></a><a class="link" href="#preparing.and.registering.clients.salt">Registering Salt Clients</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are currently three methods for registering Salt minions.
This section describes the first method and uses a bootstrap repository.
The second method uses bootstrap script, and is described in <a href="#registering.clients.traditional">Registering Traditional Clients</a>.
The third method uses the WebUI, and is described in <a href="#ref.webui.systems.bootstrapping">[ref.webui.systems.bootstrapping]</a>.</p>
</div>
<div class="paragraph">
<p>You can also use these methods to change existing traditional clients into Salt minions.</p>
</div>
<div class="paragraph">
<p>The following section assumes you have created a SUSE Manager tools repository.
You can review creating a tools repository in <a href="#create.tools.repository">Creating the  Tools Repository</a>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title=":warning:"></i>
</td>
<td class="content">
<div class="title">Ensure the Salt Master is Reachable During Bootstrap</div>
<div class="paragraph">
<p>The Salt master and its proxy should always be reachable via both IP address and the FQDN.
In the following rare scenario:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Salt master (SUSE Manager) is in some DNS.</p>
</li>
<li>
<p>Your Minions are in a different subnet bound to an alternate DNS and the Salt master record is absent.</p>
</li>
<li>
<p>The Salt master cannot know that the minion is not utilizing the same DNS record. The the Salt master nevertheless sends the FQDN of itself to the minion expecting it to join.</p>
</li>
<li>
<p>The minion looks for a different DNS, one where the master record does not exist therefore bootstrap fails.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once you have fully synced a base channel from the WebUI
for clients to obtain software sources from, for example: <code>SLES12-SP3-Pool_for_x86_64</code> perform the following procedure to register a Salt minion.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure: Registering Salt Minions</div>
<ol class="arabic">
<li>
<p>On your minion as {rootuser} enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre>zypper ar http://`FQDN.SUSE.Manager.com`/pub/repositories/sle/12/3/bootstrap/ \
   sles12-sp3</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title=":information_source:"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not use <code>HTTPS</code>.
Use <code>HTTP</code> instead to avoid errors.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>After adding the repository containing the necessary Salt packages execute:</p>
<div class="listingblock">
<div class="content">
<pre>zypper in salt-minion</pre>
</div>
</div>
</li>
<li>
<p>Modify the minion configuration file to point to the fully qualified domain name (<code class="replaceable">FQDN</code>) of the  server (master):</p>
<div class="listingblock">
<div class="content">
<pre>vi /etc/salt/minion</pre>
</div>
</div>
<div class="paragraph">
<p>Find and change the line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>master: salt</pre>
</div>
</div>
<div class="paragraph">
<p>to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>master:`FQDN.SUSE.Manager.com`</pre>
</div>
</div>
</li>
<li>
<p>Restart the Salt minion with:</p>
<div class="listingblock">
<div class="content">
<pre>systemctl restart salt-minion</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Your newly registered minion should now show up within the WebUI under <span class="menuseq"><b class="menu">Salt</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Keys</b></span>.
Accept the <code class="guimenu">pending</code> key to begin management.</p>
</div>
<div class="paragraph">
<p>If you have used your hypervisor clone utility, and attempted to register the cloned Salt client, you might get this error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>We're sorry, but the system could not be found.</pre>
</div>
</div>
<div class="paragraph">
<p>This is caused by the new, cloned, system having the same machine ID as an existing, registered, system.
You can adjust this manually to correct the error and register the cloned system successfully.</p>
</div>
<div class="paragraph">
<p>For more information and instructions, see <a href="#">bp.chapt.suma3.troubleshooting.adoc#bp.chapt.suma3.troubleshooting.registering.cloned.salt.systems</a>.</p>
</div>
</div>
</div>
</article>
  </main>
</div>
<footer class="footer">
  <p>Copyright (C) 2017-2018 <a href="https://jcayouette.github.io/personal-blog">Belief and Reason</a></p>
  <p>Except where otherwise noted, jcayouette.github.io/personal-blog, BoR, are licensed under the <a href="https://www.mozilla.org/en-US/MPL/2.0/">Mozilla Public License Version 2.0</a> (MPL-2.0).</p>
</footer>
<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js -->
<script>
function focusSearchInput () { document.querySelector('#search-input').focus() }
var search = docsearch({
  appId: '#',
  apiKey: '#',
  indexName: '#',
  inputSelector: '#search-input',
  autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
  algoliaOptions: { hitsPerPage: 10 }
}).autocomplete
search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
focusSearchInput()
window.addEventListener('load', focusSearchInput)
</script>
<script src="../../_/js/site.js"></script>
<script src="../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
