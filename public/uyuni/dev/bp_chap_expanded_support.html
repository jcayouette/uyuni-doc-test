<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expanded Support :: Uyuni Documentation (Prototype)</title>
    <meta name="generator" content="Antora 1.0.3">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/site-extra.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
    <!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css -->
    <link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a href="https://jcayouette.github.io/personal-blog">Belief and Reason</a>
        <span class="separator">//</span>
        <a href="../..">Library</a>
      </div>
      <div class="navbar-item">
        <input id="search-input" type="text" placeholder="Search docs">
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Projects</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>Resources</strong></div>
            <a class="navbar-item" href="https://github.com/jcayouette/personal-blog">Repository</a>
            <a class="navbar-item" href="https://github.com/jcayouette/personal-blog/issues">Issue Tracker</a>
<!--
            <hr class="navbar-divider">
            <div class="navbar-item"><strong>Custom UI (coming soon!)</strong></div>
            <a class="navbar-item" href="https://gitlab.com/antora/antora-ui-default">Repository</a>
            <a class="navbar-item" href="https://gitlab.com/antora/antora-ui-default/issues">Issue Tracker</a>
            <hr class="navbar-divider">
          -->
            <a class="navbar-item" href="https://github.com/jcayouette/blob/master/contributing.adoc">Contributing</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Community</div>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://discord.gg/vmrAYE3">Discord Chat</a>
          </div>
        </div>
        <a class="navbar-item" href="https://twitter.com/BaR-project">
          <span class="icon">
            <svg aria-hidden="true" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
              <path fill="#57aaee" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path>
            </svg>
          </span>
        </a>
      </div>
    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="uyuni" data-version="dev">
  <aside class="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="MAIN-manager.html">Uyuni</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="book_mgr_getting_started.html">Getting Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="quickstart3_chap_install_overview.html">Overview and Requirements</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.introduction">Introduction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq">Prerequisites for Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq.scc">SUSE SCC Credentials</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq.installmedia">Get Uyuni</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq.hardware">Hardware Requirements</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq.network">Network Requirements</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq.clientos">Supported Client Systems</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="quickstart3_chap_suma_installation_jeos.html">Installation via JeOS</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.kvm.settings">Configuring KVM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#jeos.kvm.settings">JeOS KVM Settings</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#jeos.susemgr.prep">Preparing JeOS for Uyuni</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quickstart3_chap_suma_installation_sles.html">Installation via SLES</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quickstart3_chap_suma_setup_with_yast.html">Setup and Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quickstart3_chap_suma_keys_and_first_client.html">Connecting Clients</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quickstart3_chap_suma_salt_gs.html">Introduction to Salt</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="book_mgr_best_practices.html">Best Practices</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="book_suma_reference_manual.html">WebUI Reference</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="book_suma_advanced_topics.html">Advanced Topics</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Uyuni</span>
    <span class="version">dev</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Uyuni</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="MAIN-manager.html">dev</a>
        </li>
        <li class="version">
          <a href="../3.2/MAIN-manager.html">3.2</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="MAIN-manager.html" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="MAIN-manager.html">Uyuni</a></li>
    <li class="crumb"><a href="bp_chap_expanded_support.html">Expanded Support</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="versions-menu-toggle" title="Show other versions of page">dev</button>
  <div class="versions-menu">
    <a class="version is-current" href="bp_chap_expanded_support.html">dev</a>
    <a class="version" href="../3.2/bp_chap_expanded_support.html">3.2</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/jcayouette/uyuni-doc-test/edit/master/docs/modules/ROOT/pages/bp_chap_expanded_support.adoc">Edit this Page</a></div>
</div>
<article class="doc">
<h1>Expanded Support</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#bp.expanded-support.resclients">Managing Red Hat Enterprise Linux Clients</a>
<ul class="sectlevel2">
<li><a href="#bp.expanded-support.resclients.server">Server Configuration for Red Hat Enterprise Linux Channels</a></li>
<li><a href="#bp.expanded-support.resclients.tips">Red Hat Enterprise Linux Channel Management Tips</a></li>
<li><a href="#_mirroring_rhel_media_into_a_channel">Mirroring RHEL Media into a Channel</a></li>
<li><a href="#_registering_res_salt_minions_with">Registering RES Salt Minions with </a></li>
<li><a href="#_register_a_salt_minion_via_bootstrap">Register a Salt Minion via Bootstrap</a></li>
<li><a href="#_manual_salt_minion_registration">Manual Salt Minion Registration</a></li>
</ul>
</li>
<li><a href="#bp.expanded-support.centos_repos.trad">Preparing Channels and Repositories for CentOS Traditional Clients</a></li>
<li><a href="#bp.expanded-support.centos_salt">Registering CentOS Salt Minions with </a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In the following sections find information about Red Hat and Centos clients.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bp.expanded-support.resclients"><a class="anchor" href="#bp.expanded-support.resclients"></a><a class="link" href="#bp.expanded-support.resclients">Managing Red Hat Enterprise Linux Clients</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following sections provide guidance on managing Red Hat Expanded Support clients, this includes Salt minions and traditional systems.</p>
</div>
<div class="sect2">
<h3 id="bp.expanded-support.resclients.server"><a class="anchor" href="#bp.expanded-support.resclients.server"></a><a class="link" href="#bp.expanded-support.resclients.server">Server Configuration for Red Hat Enterprise Linux Channels</a></h3>
<div class="paragraph">
<p>This section provides guidance on server configuration for Red Hat Enterprise Linux Channels provided by SUSE.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Minimum of 8 GB RAM and at least two physical or virtual CPUs. Taskomatic will use one of these CPUs.</p>
</li>
<li>
<p>Taskomatic requires of minimum of 3072 MB RAM. This should be set in <code class="path">/etc/rhn/rhn.conf</code>:</p>
<div class="listingblock">
<div class="content">
<pre>taskomatic.java.maxmemory=3072</pre>
</div>
</div>
</li>
<li>
<p>Provision enough disk space. <code class="path">/var/spacewalk</code> contains all mirrored RPMs. For example, Red Hat Enterprise Linux 6 x86_64 channels require 90 GB and more.</p>
</li>
<li>
<p>LVM or an NFS mount is recommended.</p>
</li>
<li>
<p>Access to RHEL 5/6/7 Subscription Media.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title=":warning:"></i>
</td>
<td class="content">
<div class="title">Access to RHEL Media or Repositories</div>
<div class="paragraph">
<p>Access to Red Hat base media repositories and RHEL installation media is the responsibility of the user.
Ensure that all your RHEL systems obtain support from RHEL or all your RHEL systems obtain support from SUSE.
If you do not follow these practices you may violate terms with Red Hat.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="bp.expanded-support.resclients.tips"><a class="anchor" href="#bp.expanded-support.resclients.tips"></a><a class="link" href="#bp.expanded-support.resclients.tips">Red Hat Enterprise Linux Channel Management Tips</a></h3>
<div class="paragraph">
<p>This section provides tips on Red Hat Enterprise Linux channel management.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The base parent distribution Red Hat Enterprise Linux channel per architecture contains zero packages. No base media is provided by SUSE. The RHEL media or installation ISOs should be added as child channels of the Red Hat Enterprise Linux parent channel.</p>
</li>
<li>
<p>The Red Hat Enterprise Linux and tools channels are provided by SUSE Customer Center (SCC) using <code class="command">mgr-sync</code>.</p>
</li>
<li>
<p>It can take up to 24 hours for an initial channel synchronization to complete.</p>
</li>
<li>
<p>When you have completed the initial synchronization process of any Red Hat Enterprise Linux channel it is recommended to clone the channel before working with it. This provides you with a backup of the original synchronization.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_mirroring_rhel_media_into_a_channel"><a class="anchor" href="#_mirroring_rhel_media_into_a_channel"></a><a class="link" href="#_mirroring_rhel_media_into_a_channel">Mirroring RHEL Media into a Channel</a></h3>
<div class="paragraph">
<p>The following procedure guides you through setup of the RHEL media as a  channel.
All packages on the RHEL media will be mirrored into a child channel located under RES 5/6/7 distribution per architecture.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure: Mirroring RHEL Media into a Channel</div>
<ol class="arabic">
<li>
<p>Create a new Channel by log in to the WebUI and selecting <span class="menuseq"><b class="menu">Channels</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Manage Software Channels</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Create Channel</b></span> .</p>
</li>
<li>
<p>Fill in basic channel details and add the channel as a child to the corresponding RES 5/6/7 distribution channel per architecture from SCC. The base parent channel should contain zero packages.</p>
</li>
<li>
<p>Modify the RES 5/6/7 activation key to include this new child channel.</p>
</li>
<li>
<p>As {rootuser} on the  command line copy the ISO to the <code class="path">/tmp</code> directory.</p>
</li>
<li>
<p>Create a directory to contain the media content:</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}mkdir -p /srv/www/htdocs/pub/rhel</pre>
</div>
</div>
</li>
<li>
<p>Mount the ISO:</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}mount -o loop /tmp/name_of_iso /srv/www/htdocs/pub/rhel</pre>
</div>
</div>
</li>
<li>
<p>Start <code class="command">spacewalk-repo-sync</code> to synchronize Red Hat Enterprise Linux 7 packages:</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}spacewalk-repo-sync -c channel_name -u https://127.0.0.1/pub/rhel/
Repo URL: https://127.0.0.1/pub/rhel/
Packages in repo:              [...]
Packages already synced:       [...]
Packages to sync:              [...]
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>To synchronize RES 5/6 packages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}spacewalk-repo-sync -c channel_name -u https://127.0.0.1/pub/rhel/Server/
Repo URL: https://127.0.0.1/pub/rhel/Server/
Packages in repo:              [...]
Packages already synced:       [...]
Packages to sync:              [...]
[...]</pre>
</div>
</div>
</li>
<li>
<p>When the channel has completed the synchronization process you can use the channel as any normal  channel.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Attempting to synchronize the repository will sometimes fail with this error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[Errno 256] No more mirrors to try.</pre>
</div>
</div>
<div class="paragraph">
<p>To troubleshoot this error, look at the HTTP protocol to determine if <code class="command">spacewalk-repo-sync</code> is running:</p>
</div>
<div class="olist arabic">
<div class="title">procedure: Debug spacewalk-repo-sync</div>
<ol class="arabic">
<li>
<p>Start debugging mode with <code class="command">export URLGRABBER_DEBUG=DEBUG</code></p>
</li>
<li>
<p>Check the output of <code class="command">/usr/bin/spacewalk-repo-sync --channel <em>&lt;channel-label&gt;</em> --type yum</code></p>
</li>
<li>
<p>If you want to disable debug mode, use <code class="command">unset URLGRABBER_DEBUG</code></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_registering_res_salt_minions_with"><a class="anchor" href="#_registering_res_salt_minions_with"></a><a class="link" href="#_registering_res_salt_minions_with">Registering RES Salt Minions with </a></h3>
<div class="paragraph">
<p>This section will guide you through registering RHEL minions with .</p>
</div>
<div class="paragraph">
<p>This section assumes you have updated your server to the latest patch level.</p>
</div>
<div class="sect3">
<h4 id="_synchronizing_appropriate_red_hat_enterprise_linux_channels"><a class="anchor" href="#_synchronizing_appropriate_red_hat_enterprise_linux_channels"></a><a class="link" href="#_synchronizing_appropriate_red_hat_enterprise_linux_channels">Synchronizing Appropriate Red Hat Enterprise Linux Channels</a></h4>
<div class="paragraph">
<p>Ensure you have the corresponding Red Hat Enterprise Linux product enabled and required channels have been fully synchronized:</p>
</div>
<div class="ulist">
<div class="title">RHEL 7.x</div>
<ul>
<li>
<p>Product: Red Hat Enterprise Linux 7</p>
</li>
<li>
<p>Mandatory channels: <code class="systemitem">rhel-x86_64-server-7</code> , <code class="systemitem">res7-suse-manager-tools-x86_64</code> , <code class="systemitem">res7-x86_64</code> systemitem&gt;</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">RHEL 6.x</div>
<ul>
<li>
<p>Product: Red Hat Enterprise Linux 6</p>
</li>
<li>
<p>Mandatory channels: <code class="systemitem">rhel-x86_64-server-6</code> , <code class="systemitem">res6-suse-manager-tools-x86_64</code> , <code class="systemitem">res6-x86_64</code></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title=":bulb:"></i>
</td>
<td class="content">
<div class="title">Checking Synchronization Progress</div>
<div class="paragraph">
<p>To check if a channel has finished synchronizing you can do one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>From the WebUI browse to <span class="menuseq"><b class="menu">Admin</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Setup Wizard</b></span> and select the <b class="menuref">SUSE Products</b> tab. Here you will find a percent completion bar for each product.</p>
</li>
<li>
<p>Alternatively, you may check the synchronization log file located under <code class="path">/var/log/rhn/reposync/channel-label.log</code> using cat or the tailf command. Keep in mind that base channels can contain multiple child channels. Each of these child channels will generate its own log during the synchronization progress. Do not assume a channel has finished synchronizing until you have checked all relevant log files including base and child channels.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Create an activation key associated with the Red Hat Enterprise Linux channel.</p>
</div>
</div>
<div class="sect3">
<h4 id="_creating_a_bootstrap_repository"><a class="anchor" href="#_creating_a_bootstrap_repository"></a><a class="link" href="#_creating_a_bootstrap_repository">Creating a Bootstrap Repository</a></h4>
<div class="paragraph">
<p>The following procedure demonstrate creating a bootstrap repository for RHEL:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On the server command line as root, create a bootstrap repo for RHEL with the following command:</p>
<div class="listingblock">
<div class="content">
<pre>mgr-create-bootstrap-repo RHEL_activation_channel_key</pre>
</div>
</div>
</li>
<li>
<p>Rename <code class="command">bootstrap.sh</code> to <code class="command">resversion-boostrap.sh</code>:</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}cp bootstrap.sh res7-bootstrap.sh</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_register_a_salt_minion_via_bootstrap"><a class="anchor" href="#_register_a_salt_minion_via_bootstrap"></a><a class="link" href="#_register_a_salt_minion_via_bootstrap">Register a Salt Minion via Bootstrap</a></h3>
<div class="paragraph">
<p>The following procedure will guide you through registering a Salt minion using the bootstrap script.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure: Registration Using the Bootstrap Script</div>
<ol class="arabic">
<li>
<p>For your new minion download the bootstrap script from the  server:</p>
<div class="listingblock">
<div class="content">
<pre>wget --no-check-certificate https://`server`/pub/bootstrap/res7-bootstrap.sh</pre>
</div>
</div>
</li>
<li>
<p>Add the appropriate res-gpg-pubkey-<mark><mark></mark>-<mark></mark></mark>.key to the <code>ORG_GPG_KEY</code> key parameter, comma delimited in your <code class="command">res7-bootstrap.sh</code> script. These are located on your  server at:</p>
<div class="listingblock">
<div class="content">
<pre>http://`server`/pub/</pre>
</div>
</div>
</li>
<li>
<p>Make the <code class="command">res7-bootstrap.sh</code> script executable and run it. This will install necessary Salt packages from the bootstrap repository and start the Salt minion service:</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}chmod +x res7-bootstrap.sh{prompt.root}./res7-boostrap.sh</pre>
</div>
</div>
</li>
<li>
<p>From the  WebUI select <span class="menuseq"><b class="menu">Salt</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Keys</b></span> and accept the new minion&#8217;s key.</p>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title=":heavy_exclamation_mark:"></i>
</td>
<td class="content">
<div class="title">Troubleshooting Bootstrap</div>
<div class="paragraph">
<p>If bootstrapping a minion fails it is usually caused by missing packages.
These missing packages are contained on the RHEL installation media.
The RHEL installation media should be loop mounted and added as a child channel to the Red Hat Enterprise Linux channel.
See the warning in <a href="#bp.expanded-support.resclients">Managing Red Hat Enterprise Linux Clients</a> on access to RHEL Media.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_manual_salt_minion_registration"><a class="anchor" href="#_manual_salt_minion_registration"></a><a class="link" href="#_manual_salt_minion_registration">Manual Salt Minion Registration</a></h3>
<div class="paragraph">
<p>The following procedure will guide you through the registration of a Salt minion manually.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the bootstrap repository:</p>
<div class="listingblock">
<div class="content">
<pre>yum-config-manager --add-repo https://`server`/pub/repositories/res/7/bootstrap</pre>
</div>
</div>
</li>
<li>
<p>Install the <span class="package">salt-minion</span> package:</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}yum install salt-minion</pre>
</div>
</div>
</li>
<li>
<p>Edit the Salt minion configuration file to point to the  server:</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}mkdir /etc/salt/minion.d{prompt.root}echo "master:`server_fqdn`" &gt; /etc/salt/minion.d/susemanager.conf</pre>
</div>
</div>
</li>
<li>
<p>Start the minion service:</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}systemctl start salt-minion</pre>
</div>
</div>
</li>
<li>
<p>From the  WebUI select the <span class="menuseq"><b class="menu">Salt</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Keys</b></span> and accept the new minion&#8217;s key.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bp.expanded-support.centos_repos.trad"><a class="anchor" href="#bp.expanded-support.centos_repos.trad"></a><a class="link" href="#bp.expanded-support.centos_repos.trad">Preparing Channels and Repositories for CentOS Traditional Clients</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This following section provides an example procedure for configuring CentOS channels and repositories and finally registering a CentOS client with .</p>
</div>
<div class="paragraph">
<p>These steps will be identical for Scientific Linux and Fedora.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure: Preparing Channels and Repositories</div>
<ol class="arabic">
<li>
<p>As {rootuser} install <span class="package">spacewalk-utils</span> on your  server:</p>
<div class="listingblock">
<div class="content">
<pre>zypper in spacewalk-utils</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title=":heavy_exclamation_mark:"></i>
</td>
<td class="content">
<div class="title">Supported Tools</div>
The <span class="package">spacewalk-utils</span> package contains a collection of upstream command line tools which provide assistance with spacewalk administrative operations.
You will be using the <code class="command">spacewalk-common-channels</code> tool.
Keep in mind SUSE only provides support for <code class="command">spacewalk-clone-by-date</code> and <code class="command">spacewalk-manage-channel-lifecycle</code> tools.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Run the <code class="command">spacewalk-common-channels</code> script to add the CentOS7 base, updates, and Spacewalk client channels.</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}spacewalk-common-channels -u admin -p`secret`-a x86_64 'centos7'{prompt.root}spacewalk-common-channels -u admin -p`secret`-a x86_64 'centos7-updates'{prompt.root}spacewalk-common-channels -u admin -p`secret`-a x86_64 'spacewalk26-client-centos7'</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title=":information_source:"></i>
</td>
<td class="content">
<div class="title">Required Channel References</div>
The <code class="path">/etc/rhn/spacewalk-common-channels.ini</code> must contain the channel references to be added.
If a channel is not listed, check the latest version here for updates: <a href="https://github.com/spacewalkproject/spacewalk/tree/master/utils" class="bare">https://github.com/spacewalkproject/spacewalk/tree/master/utils</a>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>From the WebUI select <span class="menuseq"><b class="menu">Main Menu</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Software</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Manage Software Channels</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Overview</b></span>. Select the base channel you want to synchronize, in this case <code>CentOS7 (x86_64)</code>. Select <span class="menuseq"><b class="menu">Repositories</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Sync</b></span>. Check the channels you want to synchronize and then click the <b class="button">Sync Now</b> button or, optionally, schedule a regular synchronization time.</p>
</li>
<li>
<p>Copy all relevant GPG keys to <code class="path">/srv/www/htdocs/pub</code>. Depending on what distribution you are interested in managing these could include an EPEL key, SUSE keys, Red Hat keys, and CentOS keys. After copying these you can reference them in a comma-delimited list within your bootstrap script (see <a href="#proc.bp.expanded-support.centos-repos.trad.bsscript">Procedure: Preparing the Bootstrap Script</a>).</p>
<div class="ulist">
<ul>
<li>
<p>CentOS7 key files: <a href="http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-7" class="bare">http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-7</a></p>
</li>
<li>
<p>EPEL key file: <a href="http://mirrors.kernel.org/fedora-epel/RPM-GPG-KEY-EPEL-7" class="bare">http://mirrors.kernel.org/fedora-epel/RPM-GPG-KEY-EPEL-7</a></p>
</li>
<li>
<p>Spacewalk key: <a href="http://spacewalk.redhat.com/yum/RPM-GPG-KEY-spacewalk-2015" class="bare">http://spacewalk.redhat.com/yum/RPM-GPG-KEY-spacewalk-2015</a></p>
</li>
<li>
<p>Red Hat keys: <a href="http://www.redhat.com/contact/security-response-team/gpg-keys.html" class="bare">http://www.redhat.com/contact/security-response-team/gpg-keys.html</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Install and setup a CentOS 7 client with the default installation packages.</p>
</li>
<li>
<p>Ensure the client machine can resolve itself and your  server via DNS. Validate that there is an entry in <code class="path">/etc/hosts</code> for the real IP address of the client.</p>
</li>
<li>
<p>Create an activation key (<code>centos7</code>) on the  server that points to the correct parent/child channels, including the CentOS base repo, updates, and Spacewalk client.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now prepare the bootstrap script.</p>
</div>
<div id="proc.bp.expanded-support.centos-repos.trad.bsscript" class="olist arabic">
<div class="title">Procedure: Preparing the Bootstrap Script</div>
<ol class="arabic">
<li>
<p>Create/edit your bootstrap script to correctly reflect the following:</p>
<div class="listingblock">
<div class="content">
<pre># can be edited, but probably correct (unless created during initial install):

# NOTE: ACTIVATION_KEYS *must* be used to bootstrap a client machine.

ACTIVATION_KEYS=1-centos7

ORG_GPG_KEY=res.key,RPM-GPG-KEY-CentOS-7,suse-307E3D54.key,suse-9C800ACA.key,RPM-GPG-KEY-spacewalk-2015

FULLY_UPDATE_THIS_BOX=0

yum clean all
# Install the prerequisites
yum -y install yum-rhn-plugin rhn-setup</pre>
</div>
</div>
</li>
<li>
<p>Add the following lines to the bottom of your script, (just before <code>echo &#8220;-bootstrap complete -&#8221;</code>):</p>
<div class="listingblock">
<div class="content">
<pre># This section is for commands to be executed after registration
mv /etc/yum.repos.d/Cent* /root/
yum clean all
chkconfig rhnsd on
chkconfig osad on
service rhnsd restart
service osad restart</pre>
</div>
</div>
</li>
<li>
<p>Continue by following normal bootstrap procedures to bootstrap the new client.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bp.expanded-support.centos_salt"><a class="anchor" href="#bp.expanded-support.centos_salt"></a><a class="link" href="#bp.expanded-support.centos_salt">Registering CentOS Salt Minions with </a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following procedure will guide you through registering a CentOS Minion.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title=":warning:"></i>
</td>
<td class="content">
<div class="title">Support for CentOS Patches</div>
<div class="paragraph">
<p>CentOS uses patches originating from CentOS is not officially supported by SUSE
.
See the matrix of  clients on the main page of the  wiki, linked from the <em class="ref">Quick Links</em> section: <a href="https://wiki.microfocus.com/index.php?title=SUSE_Manager" class="bare">https://wiki.microfocus.com/index.php?title=SUSE_Manager</a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure: Register a CentOS 7 Minion</div>
<ol class="arabic">
<li>
<p>Add the Open Build Service repo for Salt:</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}yum-config-manager --add-repo http://download.opensuse.org/repositories/systemsmanagement:/saltstack:/products/RHEL_7/</pre>
</div>
</div>
</li>
<li>
<p>Import the repo key:</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}rpm --import http://download.opensuse.org/repositories/systemsmanagement:/saltstack:/products/RHEL_7/repodata/repomd.xml.key</pre>
</div>
</div>
</li>
<li>
<p>Check if there is a different repository that contains Salt. If there is more than one repository listed disable the repository that contains Salt apart from the OBS one.</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}yum list --showduplicates salt</pre>
</div>
</div>
</li>
<li>
<p>Install the Salt minion:</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}yum install salt salt-minion</pre>
</div>
</div>
</li>
<li>
<p>Change the Salt configuration to point to the  server:</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}mkdir -p /etc/salt/minion.d{prompt.root}echo "master:`server_fqdn`" &gt; /etc/salt/minion.d/susemanager.conf</pre>
</div>
</div>
</li>
<li>
<p>Restart the minion</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}systemctl restart salt-minion</pre>
</div>
</div>
</li>
<li>
<p>Proceed to <span class="menuseq"><b class="menu">Main Menu</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Salt</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Keys</b></span> from the WebUI and accept the minion&#8217;s key.</p>
</li>
</ol>
</div>
</div>
</div>
</article>
  </main>
</div>
<footer class="footer">
  <p>Copyright (C) 2017-2018 <a href="https://jcayouette.github.io/personal-blog">Belief and Reason</a></p>
  <p>Except where otherwise noted, jcayouette.github.io/personal-blog, BoR, are licensed under the <a href="https://www.mozilla.org/en-US/MPL/2.0/">Mozilla Public License Version 2.0</a> (MPL-2.0).</p>
</footer>
<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js -->
<script>
function focusSearchInput () { document.querySelector('#search-input').focus() }
var search = docsearch({
  appId: '#',
  apiKey: '#',
  indexName: '#',
  inputSelector: '#search-input',
  autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
  algoliaOptions: { hitsPerPage: 10 }
}).autocomplete
search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
focusSearchInput()
window.addEventListener('load', focusSearchInput)
</script>
<script src="../../_/js/site.js"></script>
<script src="../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
