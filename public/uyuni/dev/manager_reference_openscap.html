<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Security via OpenSCAP :: Uyuni Documentation (Prototype)</title>
    <meta name="generator" content="Antora 1.0.3">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/site-extra.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
    <!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css -->
    <link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a href="https://jcayouette.github.io/personal-blog">Belief and Reason</a>
        <span class="separator">//</span>
        <a href="../..">Library</a>
      </div>
      <div class="navbar-item">
        <input id="search-input" type="text" placeholder="Search docs">
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Projects</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>Resources</strong></div>
            <a class="navbar-item" href="https://github.com/jcayouette/personal-blog">Repository</a>
            <a class="navbar-item" href="https://github.com/jcayouette/personal-blog/issues">Issue Tracker</a>
<!--
            <hr class="navbar-divider">
            <div class="navbar-item"><strong>Custom UI (coming soon!)</strong></div>
            <a class="navbar-item" href="https://gitlab.com/antora/antora-ui-default">Repository</a>
            <a class="navbar-item" href="https://gitlab.com/antora/antora-ui-default/issues">Issue Tracker</a>
            <hr class="navbar-divider">
          -->
            <a class="navbar-item" href="https://github.com/jcayouette/blob/master/contributing.adoc">Contributing</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Community</div>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://discord.gg/vmrAYE3">Discord Chat</a>
          </div>
        </div>
        <a class="navbar-item" href="https://twitter.com/BaR-project">
          <span class="icon">
            <svg aria-hidden="true" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
              <path fill="#57aaee" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path>
            </svg>
          </span>
        </a>
      </div>
    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="uyuni" data-version="dev">
  <aside class="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="MAIN-manager.html">Uyuni</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="book_mgr_getting_started.html">Getting Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="quickstart3_chap_install_overview.html">Overview and Requirements</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.introduction">Introduction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq">Prerequisites for Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq.scc">SUSE SCC Credentials</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq.installmedia">Get Uyuni</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq.hardware">Hardware Requirements</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq.network">Network Requirements</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.prereq.clientos">Supported Client Systems</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="quickstart3_chap_suma_installation_jeos.html">Installation via JeOS</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quickstart.sect.kvm.settings">Configuring KVM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#jeos.kvm.settings">JeOS KVM Settings</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#jeos.susemgr.prep">Preparing JeOS for Uyuni</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quickstart3_chap_suma_installation_sles.html">Installation via SLES</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quickstart3_chap_suma_setup_with_yast.html">Setup and Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quickstart3_chap_suma_keys_and_first_client.html">Connecting Clients</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quickstart3_chap_suma_salt_gs.html">Introduction to Salt</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="book_mgr_best_practices.html">Best Practices</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="book_suma_reference_manual.html">WebUI Reference</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="book_suma_advanced_topics.html">Advanced Topics</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Uyuni</span>
    <span class="version">dev</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Uyuni</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="MAIN-manager.html">dev</a>
        </li>
        <li class="version">
          <a href="../3.2/MAIN-manager.html">3.2</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="MAIN-manager.html" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="MAIN-manager.html">Uyuni</a></li>
    <li class="crumb"><a href="manager_reference_openscap.html">System Security via OpenSCAP</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="versions-menu-toggle" title="Show other versions of page">dev</button>
  <div class="versions-menu">
    <a class="version is-current" href="manager_reference_openscap.html">dev</a>
    <a class="version" href="../3.2/manager_reference_openscap.html">3.2</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/jcayouette/uyuni-doc-test/edit/master/docs/modules/ROOT/pages/manager_reference_openscap.adoc">Edit this Page</a></div>
</div>
<article class="doc">
<h1>System Security via OpenSCAP</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#s1-openscap-features">OpenSCAP Features</a></li>
<li><a href="#s1-openscap-suma-prerq">Prerequisites for Using OpenSCAP in </a></li>
<li><a href="#s2-openscap-suma-audit-scans">Performing Audit Scans</a></li>
<li><a href="#s2-openscap-suma-audit-scans_view">Viewing SCAP Results</a></li>
<li><a href="#s2-openscap-suma-pages">OpenSCAP  Web Interface</a>
<ul class="sectlevel2">
<li><a href="#_openscap_scans_page">OpenSCAP Scans Page</a></li>
<li><a href="#sm-audit-page">Systems Audit Page</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The Security Certification and Authorization Package (SCAP) is a standardized compliance checking solution for enterprise-level Linux infrastructures.
It is a line of specifications maintained by the National Institute of Standards and Technology (NIST) for maintaining system security for enterprise systems.</p>
</div>
<div class="paragraph">
<p> uses OpenSCAP to implement the SCAP specifications.
OpenSCAP is an auditing tool that utilizes the Extensible Configuration Checklist Description Format (XCCDF). XCCDF is a standard way of expressing checklist content and defines security checklists.
It also combines with other specifications such as Common Platform Enumeration (CPE), Common Configuration Enumeration (CCE), and Open Vulnerability and Assessment Language (OVAL), to create a SCAP-expressed checklist that can be processed by SCAP-validated products.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="s1-openscap-features"><a class="anchor" href="#s1-openscap-features"></a><a class="link" href="#s1-openscap-features">OpenSCAP Features</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenSCAP verifies the presence of patches by using content produced by the SUSE Security Team (<a href="https://www.suse.com/support/security/" class="bare">https://www.suse.com/support/security/</a>), checks system security configuration settings and examines systems for signs of compromise by using rules based on standards and specifications.</p>
</div>
<div class="paragraph">
<p>To effectively use OpenSCAP, the following must be available:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">A tool to verify a system confirms to a standard</dt>
<dd>
<p> uses OpenSCAP as an auditing feature.
It allows you to schedule and view compliance scans for any system.</p>
</dd>
<dt class="hdlist1">SCAP content</dt>
<dd>
<p>SCAP content files defining the test rules can be created from scratch if you understand at least XCCDF or OVAL.
XCCDF content is also frequently published online under open source licenses and this content can be customized to suit your needs.</p>
<div class="paragraph">
<p>The <code class="systemitem">openscap-content</code>
package provides default content guidance for systems via a template.</p>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title=":information_source:"></i>
</td>
<td class="content">
<div class="paragraph">
<p>SUSE
supports the use of templates to evaluate your systems.
However, you are creating custom content at your own risk.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>SCAP was created to provide a standardized approach to maintaining system security, and the standards that are used will therefore continually change to meet the needs of the community and enterprise businesses.
New specifications are governed by NIST&#8217;s SCAP Release cycle in order to provide a consistent and repeatable revision work flow.
For more information, see <a href="http://scap.nist.gov/timeline.html" class="bare">http://scap.nist.gov/timeline.html</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="s1-openscap-suma-prerq"><a class="anchor" href="#s1-openscap-suma-prerq"></a><a class="link" href="#s1-openscap-suma-prerq">Prerequisites for Using OpenSCAP in </a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following sections describe the server and client prerequisites for using OpenSCAP.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Package Requirements</dt>
<dd>
<p>As Server: 
1.7 or later.</p>
<div class="paragraph">
<p>For the Client: <code class="systemitem">spacewalk-oscap</code> package (available from the  Tools Child Channel).</p>
</div>
</dd>
<dt class="hdlist1">Other Requirements</dt>
<dd>
<p>Client: Distribution of the XCCDF content to all client machines.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title=":information_source:"></i>
</td>
<td class="content">
<div class="title">OpenSCAP Auditing Availability</div>
<div class="paragraph">
<p>OpenSCAP auditing is not available on Salt SSH minions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can distribute XCCDF content to client machines using any of the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Traditional Methods (CD, USB, NFS, scp, ftp)</p>
</li>
<li>
<p> Scripts</p>
</li>
<li>
<p>RPMs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Custom RPMs are the recommended way to distribute SCAP content to other machines.
RPM packages can be signed and verified to ensure their integrity.
Installation, removal, and verification of RPM packages can be managed from the user interface.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="s2-openscap-suma-audit-scans"><a class="anchor" href="#s2-openscap-suma-audit-scans"></a><a class="link" href="#s2-openscap-suma-audit-scans">Performing Audit Scans</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenSCAP integration in  provides the ability to perform audit scans on client systems.
This section describes the available scanning methods.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title=":heavy_exclamation_mark:"></i>
</td>
<td class="content">
<div class="title">OpenSCAP Scans via Salt ssh-push Minions</div>
<div class="paragraph">
<p>Currently performing an OpenSCAP scan is disabled in the WebUI for Salt ssh-push minions.
This functionality will be adapted and enabled in a future release.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="pro-os-suma-audit-scans-webui" class="olist arabic">
<div class="title">Procedure: Scans via the Web Interface</div>
<ol class="arabic">
<li>
<p>To perform a scan via the Web interface, log in to  .</p>
</li>
<li>
<p>Click on <b class="menuref">Systems</b> and select the target system.</p>
</li>
<li>
<p>Click on <span class="menuseq"><b class="menu">Audit</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Schedule</b></span> .</p>
</li>
<li>
<p>Fill in the Schedule New XCCDF Scan form. See <a href="#sm-audit-schedule">Schedule Page</a> for more information about the fields on this page.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title=":warning:"></i>
</td>
<td class="content">
The XCCDF content is validated before it is run on the remote system.
Specifying invalid arguments can make spacewalk-oscap fail to validate or run.
Due to security concerns the <code class="command">oscap xccdf eval</code> command only accepts a limited set of parameters.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Run the <code class="command">mgr_check</code> command to ensure the action is being picked up by the client system.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mgr_check -vv</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title=":information_source:"></i>
</td>
<td class="content">
If the  daemon (<code class="command">rhnsd</code>) or <code class="command">osad</code> are running on the client system, the action will be picked up by these services.
To check if they are running, use:
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>service rhnsd start</pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre>service osad start</pre>
</div>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="paragraph">
<p>To view the results of the scan, refer to <a href="#s2-openscap-suma-audit-scans_view">Viewing SCAP Results</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/audit_openscap_schedule_scan.png" alt="audit openscap schedule scan">
</div>
<div class="title">Figure 1. Scheduling a Scan via the Web Interface</div>
</div>
<div class="olist arabic">
<div class="title">Procedure: Scans via API</div>
<ol class="arabic">
<li>
<p>To perform an audit scan via API, choose an existing script or create a script for scheduling a system scan through <code>system.scap.scheduleXccdfScan</code>, the front end API, for example:</p>
<div class="listingblock">
<div class="content">
<pre>#!/usr/bin/python
client = xmlrpclib.Server('https://spacewalk.example.com/rpc/api')
key = client.auth.login('username', 'password')
client.system.scap.scheduleXccdfScan(key, 1000010001,
    '/usr/local/share/scap/usgcb-sled11desktop-xccdf.xml',
    '--profile united_states_government_configuration_baseline')</pre>
</div>
</div>
<div class="paragraph">
<p>Where:
<strong> <code>1000010001</code> is the system ID (sid).
</strong> <code class="path">/usr/local/share/scap/usgcb-sled11desktop-xccdf.xml</code> is the path to the content location on the client system. In this case, it assumes USGCB content in the <code class="path">/usr/local/share/scap</code> directory.
** <code class="option">--profile united_states_government_configuration_baseline</code> is an additional argument for the <code class="command">oscap</code> command. In this case, it is using the USGCB.</p>
</div>
</li>
<li>
<p>Run the script on the command-line interface of any system. The system needs the appropriate Python and XML-RPC libraries installed.</p>
</li>
<li>
<p>Run the <code class="command">mgr_check</code> command to ensure that the action is being picked up by the client system.</p>
<div class="listingblock">
<div class="content">
<pre>mgr_check -vv</pre>
</div>
</div>
<div class="paragraph">
<p>If the  daemon (<code class="command">rhnsd</code>) or <code class="command">osad</code> are running on the client system, the action will be picked up by these services.
To check if they are running, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>service rhnsd start</pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre>service osad start</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title=":information_source:"></i>
</td>
<td class="content">
<div class="title">Enabling Upload of Detailed SCAP Files</div>
<div class="paragraph">
<p>To make sure detailed information about the scan will be available, activate the upload of detailed SCAP files on the clients to be evaluated.
On the <span class="menuseq"><b class="menu">Admin</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">]
 page</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">click on menu:Organization[</b></span>
 and select one.
Click on the <span class="menuseq"><b class="menu">Configuration</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">]
 tab and check menu:Enable Upload Of Detailed SCAP Files[</b></span>
.
This feature generates an additional HTML version when you run a scan.
The results will show an extra line like: <code>Detailed Results: xccdf-report.html xccdf-results.xml
     scap-yast2sec-oval.xml.result.xml</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="s2-openscap-suma-audit-scans_view"><a class="anchor" href="#s2-openscap-suma-audit-scans_view"></a><a class="link" href="#s2-openscap-suma-audit-scans_view">Viewing SCAP Results</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are three methods of viewing the results of finished scans:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Via the Web interface. Once the scan has finished, the results should show up on the <b class="menuref">Audit</b> tab of a specific system. This page is discussed in <a href="#s2-openscap-suma-pages">OpenSCAP  Web Interface</a>.</p>
</li>
<li>
<p>Via the API functions in handler <code>system.scap</code>.</p>
</li>
<li>
<p>Via the <code class="command">spacewalk-report</code> command as follows:</p>
<div class="listingblock">
<div class="content">
<pre>spacewalk-report system-history-scap
spacewalk-report scap-scan
spacewalk-report scap-scan-results</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="s2-openscap-suma-pages"><a class="anchor" href="#s2-openscap-suma-pages"></a><a class="link" href="#s2-openscap-suma-pages">OpenSCAP  Web Interface</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following sections describe the tabs in the  WebUI that provide access to OpenSCAP and its features.</p>
</div>
<div class="sect2">
<h3 id="_openscap_scans_page"><a class="anchor" href="#_openscap_scans_page"></a><a class="link" href="#_openscap_scans_page">OpenSCAP Scans Page</a></h3>
<div class="paragraph">
<p>Click the <b class="menuref">Audit</b>
 tab on the top navigation bar, then OpenSCAP on the left.
Here you can view, search for, and compare completed OpenSCAP scans.</p>
</div>
<div class="sect3">
<h4 id="_span_class_menuseq_b_class_menu_openscap_b_i_class_fa_fa_angle_right_caret_i_b_class_submenu_b_i_class_fa_fa_angle_right_caret_i_b_class_menuitem_menu_all_scans_b_span"><a class="anchor" href="#_span_class_menuseq_b_class_menu_openscap_b_i_class_fa_fa_angle_right_caret_i_b_class_submenu_b_i_class_fa_fa_angle_right_caret_i_b_class_menuitem_menu_all_scans_b_span"></a><a class="link" href="#_span_class_menuseq_b_class_menu_openscap_b_i_class_fa_fa_angle_right_caret_i_b_class_submenu_b_i_class_fa_fa_angle_right_caret_i_b_class_menuitem_menu_all_scans_b_span"><span class="menuseq"><b class="menu">OpenSCAP</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">]</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">menu:All Scans[</b></span></a></h4>
<div class="paragraph">
<p><span class="menuseq"><b class="menu">All Scans</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">]
 is the default page that appears on the menu:Audit[OpenSCAP</b></span>
 page.
Here you see all the completed OpenSCAP scans you have permission to view.
Permissions for scans are derived from system permissions.</p>
</div>
<div class="paragraph">
<p>For each scan, the following information is displayed:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">System</dt>
<dd>
<p>the scanned system.</p>
</dd>
<dt class="hdlist1">XCCDF Profile</dt>
<dd>
<p>the evaluated profile.</p>
</dd>
<dt class="hdlist1">Completed</dt>
<dd>
<p>time of completion.</p>
</dd>
<dt class="hdlist1">Satisfied</dt>
<dd>
<p>number of rules satisfied.
A rule is considered to be satisfied if the result of the evaluation is either Pass or Fixed.</p>
</dd>
<dt class="hdlist1">Dissatisfied</dt>
<dd>
<p>number of rules that were not satisfied.
A rule is considered Dissatisfied if the result of the evaluation is a Fail.</p>
</dd>
<dt class="hdlist1">Unknown</dt>
<dd>
<p>number of rules which failed to evaluate.
A rule is considered to be Unknown if the result of the evaluation is an Error, Unknown or Not Checked.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The evaluation of XCCDF rules may also return status results like <code>Informational</code>, <code>Not Applicable</code>, or not <code>Selected</code>.
In such cases, the given rule is not included in the statistics on this page.
See <span class="menuseq"><b class="menu">System Details</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Audit</b></span>
 for information on these types of results.</p>
</div>
</div>
<div class="sect3">
<h4 id="_span_class_menuseq_b_class_menu_openscap_b_i_class_fa_fa_angle_right_caret_i_b_class_submenu_b_i_class_fa_fa_angle_right_caret_i_b_class_menuitem_menu_xccdf_diff_b_span"><a class="anchor" href="#_span_class_menuseq_b_class_menu_openscap_b_i_class_fa_fa_angle_right_caret_i_b_class_submenu_b_i_class_fa_fa_angle_right_caret_i_b_class_menuitem_menu_xccdf_diff_b_span"></a><a class="link" href="#_span_class_menuseq_b_class_menu_openscap_b_i_class_fa_fa_angle_right_caret_i_b_class_submenu_b_i_class_fa_fa_angle_right_caret_i_b_class_menuitem_menu_xccdf_diff_b_span"><span class="menuseq"><b class="menu">OpenSCAP</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">]</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">menu:XCCDF Diff[</b></span></a></h4>
<div class="paragraph">
<p>XCCDF Diff is an application that visualizes the comparison of two XCCDF scans.
It shows metadata for two scans as well as the lists of results.</p>
</div>
<div class="paragraph">
<p>Click the appropriate icon on the Scans page to access the diff output of similar scans.
Alternatively, specify the ID of scans you want to compare.</p>
</div>
<div class="paragraph">
<p>Items that show up in only one of the compared scans are considered to be "varying". Varying items are always highlighted in beige.
There are three possible comparison modes:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Full Comparison</dt>
<dd>
<p>all the scanned items.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Only Changed Items</dt>
<dd>
<p>items that have changed.</p>
</dd>
<dt class="hdlist1">Only Invariant</dt>
<dd>
<p>unchanged or similar items.</p>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_span_class_menuseq_b_class_menu_openscap_b_i_class_fa_fa_angle_right_caret_i_b_class_submenu_b_i_class_fa_fa_angle_right_caret_i_b_class_menuitem_menu_advanced_search_b_span"><a class="anchor" href="#_span_class_menuseq_b_class_menu_openscap_b_i_class_fa_fa_angle_right_caret_i_b_class_submenu_b_i_class_fa_fa_angle_right_caret_i_b_class_menuitem_menu_advanced_search_b_span"></a><a class="link" href="#_span_class_menuseq_b_class_menu_openscap_b_i_class_fa_fa_angle_right_caret_i_b_class_submenu_b_i_class_fa_fa_angle_right_caret_i_b_class_menuitem_menu_advanced_search_b_span"><span class="menuseq"><b class="menu">OpenSCAP</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">]</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">menu:Advanced Search[</b></span></a></h4>
<div class="paragraph">
<p>Use the Advanced Search page to search through your scans according to specified criteria including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>rule results,</p>
</li>
<li>
<p>targeted machine,</p>
</li>
<li>
<p>time frame of the scan.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/audit_openscap_advanced_search.png" alt="audit openscap advanced search">
</div>
<div class="title">Figure 2. OpenSCAP Advanced Search</div>
</div>
<div class="paragraph">
<p>The search either returns a list of results or a list of scans, which are included in the results.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sm-audit-page"><a class="anchor" href="#sm-audit-page"></a><a class="link" href="#sm-audit-page">Systems Audit Page</a></h3>
<div class="paragraph">
<p>To display a system&#8217;s audit page, click <span class="menuseq"><b class="menu">Systems</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">system_name</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Audit</b></span>
.
Use this page to schedule and view compliance scans for a particular system.
Scans are performed by the OpenSCAP tool, which implements NIST&#8217;s standard Security Content Automation Protocol (SCAP). Before you scan a system, make sure that the SCAP content is prepared and all prerequisites in <a href="#s1-openscap-suma-prerq">Prerequisites for Using OpenSCAP in </a> are met.</p>
</div>
<div class="sect3">
<h4 id="_list_scans"><a class="anchor" href="#_list_scans"></a><a class="link" href="#_list_scans">List Scans</a></h4>
<div class="paragraph">
<p>This subtab lists a summary of all scans completed on the system.
The following columns are displayed:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">XCCDF Test Result</dt>
<dd>
<p>The scan test result name, which provides a link to the detailed results of the scan.</p>
</dd>
<dt class="hdlist1">Completed</dt>
<dd>
<p>The exact time the scan finished.</p>
</dd>
<dt class="hdlist1">Compliance</dt>
<dd>
<p>The unweighted pass/fail ratio of compliance based on the Standard used.</p>
</dd>
<dt class="hdlist1">P</dt>
<dd>
<p>Number of checks that passed.</p>
</dd>
<dt class="hdlist1">F</dt>
<dd>
<p>Number of checks that failed.</p>
</dd>
<dt class="hdlist1">E</dt>
<dd>
<p>Number of errors that occurred during the scan.</p>
</dd>
<dt class="hdlist1">U</dt>
<dd>
<p>Unknown.</p>
</dd>
<dt class="hdlist1">N</dt>
<dd>
<p>Not applicable to the machine.</p>
</dd>
<dt class="hdlist1">K</dt>
<dd>
<p>Not checked.</p>
</dd>
<dt class="hdlist1">S</dt>
<dd>
<p>Not Selected.</p>
</dd>
<dt class="hdlist1">I</dt>
<dd>
<p>Informational.</p>
</dd>
<dt class="hdlist1">X</dt>
<dd>
<p>Fixed.</p>
</dd>
<dt class="hdlist1">Total</dt>
<dd>
<p>Total number of checks.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Each entry starts with an icon indicating the results of a comparison to a previous similar scan.
The icons indicate the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"RHN List Checked" Icon&#8201;&#8212;&#8201;no difference between the compared scans.</p>
</li>
<li>
<p>"RHN List Alert" Icon&#8201;&#8212;&#8201;arbitrary differences between the compared scans.</p>
</li>
<li>
<p>"RHN List Error" Icon&#8201;&#8212;&#8201;major differences between the compared scans. Either there are more failures than the previous scan or less passes</p>
</li>
<li>
<p>"RHN List Check In" Icon&#8201;&#8212;&#8201;no comparable scan was found, therefore, no comparison was made.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To find out what has changed between two scans in more detail, select the ones you are interested in and click <span class="menuseq"><b class="menu">Compare Selected Scans</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">]
.
To delete scans that are no longer relevant</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">select those and click on menu:Remove Selected Scans[</b></span>
.
Scan results can also be downloaded in CSV format.</p>
</div>
</div>
<div class="sect3">
<h4 id="_scan_details"><a class="anchor" href="#_scan_details"></a><a class="link" href="#_scan_details">Scan Details</a></h4>
<div class="paragraph">
<p>The Scan Details page contains the results of a single scan.
The page is divided into two sections:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Details of the XCCDF Scan</dt>
<dd>
<p>This section displays various details about the scan, including:</p>
<div class="ulist">
<ul>
<li>
<p>File System Path: the path to the XCCDF file used for the scan.</p>
</li>
<li>
<p>Command-line Arguments: any additional command-line arguments that were used.</p>
</li>
<li>
<p>Profile Identifier: the profile identifier used for the scan.</p>
</li>
<li>
<p>Profile Title: the title of the profile used for the scan.</p>
</li>
<li>
<p>Scan&#8217;s Error output: any errors encountered during the scan.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">XCCDF Rule Results</dt>
<dd>
<p>The rule results provide the full list of XCCDF rule identifiers, identifying tags, and the result for each of these rule checks.
This list can be filtered by a specific result.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sm-audit-schedule"><a class="anchor" href="#sm-audit-schedule"></a><a class="link" href="#sm-audit-schedule">Schedule Page</a></h4>
<div class="paragraph">
<p>Use the Schedule New XCCDF Scan page to schedule new scans for specific machines.
Scans occur at the system&#8217;s next scheduled check-in that occurs after the date and time specified.
The following fields can be configured:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Command-line Arguments</dt>
<dd>
<p>Optional arguments to the <code class="command">oscap</code> command, either:</p>
<div class="ulist">
<ul>
<li>
<p><code>--profile PROFILE</code>: Specifies a particular profile from the XCCDF document.</p>
<div class="paragraph">
<p>Profiles are determined by the Profile tag in the XCCDF XML file.
Use the <code class="command">oscap</code> command to see a list of profiles within a given XCCDF file, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># oscap info /usr/local/share/scap/dist_sles12_scap-sles12-oval.xml
Document type: XCCDF Checklist
Checklist version: 1.1
Status: draft
Generated: 2015-12-12
Imported: 2016-02-15T22:09:33
Resolved: false
Profiles: SLES12-Default</pre>
</div>
</div>
<div class="paragraph">
<p>If not specified, the default profile is used.
Some early versions of OpenSCAP in require that you use the <code>--profile</code> option or the scan will fail.</p>
</div>
</li>
<li>
<p><code>--skip-valid</code>: Do not validate input and output files. You can use this option to bypass the file validation process if you do not have well-formed XCCDF content.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Path to XCCDF Document</dt>
<dd>
<p>This is a required field.
The path parameter points to the XCCDF content location on the client system.
For example: <code class="path">/usr/local/share/scap/dist_sles12_scap-sles12-oval.xml</code></p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title=":warning:"></i>
</td>
<td class="content">
The XCCDF content is validated before it is run on the remote system.
Specifying invalid arguments can cause <code class="command">spacewalk-oscap</code> to fail to validate or run.
Due to security concerns, the <code class="command">oscap xccdf eval</code> command only accepts a limited set of parameters.
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For information about how to schedule scans using the WebUI
, refer to <a href="#pro-os-suma-audit-scans-webui">Procedure: Scans via the Web Interface</a>.</p>
</div>
</div>
</div>
</div>
</div>
</article>
  </main>
</div>
<footer class="footer">
  <p>Copyright (C) 2017-2018 <a href="https://jcayouette.github.io/personal-blog">Belief and Reason</a></p>
  <p>Except where otherwise noted, jcayouette.github.io/personal-blog, BoR, are licensed under the <a href="https://www.mozilla.org/en-US/MPL/2.0/">Mozilla Public License Version 2.0</a> (MPL-2.0).</p>
</footer>
<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js -->
<script>
function focusSearchInput () { document.querySelector('#search-input').focus() }
var search = docsearch({
  appId: '#',
  apiKey: '#',
  indexName: '#',
  inputSelector: '#search-input',
  autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
  algoliaOptions: { hitsPerPage: 10 }
}).autocomplete
search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
focusSearchInput()
window.addEventListener('load', focusSearchInput)
</script>
<script src="../../_/js/site.js"></script>
<script src="../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
